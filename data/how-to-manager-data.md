
# 数据开发与数据自动化

我认为，数据研发工作最核心的工作是数据开发的自动化过程，因此一切的措施的目的都是实现是数据开发自动化。

所谓数据开发自动化，就是数据开发的过程的自动化，也就是，数据需求提报的自动化，数据开发流程的自动化，数据指标管理的自动化，数据指标监控和报警的自动化，数据文档生成的自动化。

数据开发自动化会带来诸多好处，比如，减少人工介入出错的概率，提高数据处理流程效率，提高数据质量，降低数据需求维护成本。

## 数据需求提报的自动化

数据需求提报应当避免走邮件这种底效的管理方式。相比jira或者issue,邮件有缺少公开透明度，不能以链接的方式定位一封邮件的内容，不能支持代码的格式显示等缺点。
然而jira或者issue可以用http链接来唯一确定一个资源或者问题，这样就可以用程序自动化采集jira或者issue的内容，非常有利于需求自动化统计，文档自动生成。

jira或者issue都会提供一个唯一的需求编号，我们在任何地方都可以用这个编号来代表一个需求。我们用这个编号可以追踪整个需求的流程，从提报，到开发，到维护，到废弃。
然而邮件，却只能提供一个标题，这种标题具有混淆性，并且很可能只会留在某个人的邮箱中。

数据需求提报应当有一份良好的数据文档。良好的数据文档的标准是，文档拿给任何数据开发人员，开发人员可以在不和数据提报人员沟通的前提下，无障碍理解文档，进行需求开发。



## 数据开发流程的自动化

数据开发流程中有非常多的容易人工导致犯错的地方，这种错误的导致的结果是数据指标的不统一，代码格式（风格）的不统一，程序部署或运行的版本的不统一。
如果存在着这些不统一，将会使得维护代码的成本大大增加，数据质量急剧下降。一种表象就是，数据问题频出，修bug，找问题花的时间远远大于数据开发的时间。


要规避这种不统一，需要提供一个自动化的开发环境，使得开发人员只关心业务开发本身，而无需关心诸如需求指标含义、代码从头到尾如何运行、程序如何部署之类的问题。

因此，我们需要关心如下几个问题：


### 代码的统一规范

完善的编程语言，如Javascript、Java，都有包的概念，以唯一确定每个文件的代码。但是诸如SQL这种不完善的语言，缺乏包管理机制。
这导致SQL代码管理混乱不堪，代码复用率很低，代码引用关系混乱，代码缺失严重。可想而知，这样管理混乱的代码，如何保证数据的质量？

解决这个问题的方案有两种，一是用其他程序如Java实现一个SQL的包管理机制，弥补SQL的不足；二是给SQL语言本身实现一个包管理机制。

第一种方案成本最小。


SQL的代码风格不统一会严重影响团队之间的Code Review机制。因此，最好有一份SQL代码的规范。只是很可惜，SQL很少有lint之类的代码规范工具。如果要用，不妨自己开发一套。

用git分支管理代码是一个不错的选择。git带来团队协作，新代码和稳定版本的代码互相隔离，版本控制，完善的回滚机制，代码备份等功能。

### 程序部署的自动化

程序部署应当是运维关心的事情。这里不展开详述。如果在开发中，涉及到了程序部署的环节，应当警惕开发流程已经出了问题。

## 数据指标管理的自动化

应当有统一的指标索引。

给每个指标一个唯一的解释，建立指标索引。在需求提报的时候，需求人需要查询指标索引，获得一个指标ID。如果所查询的指标不存在，则需要将指标加入到指标索引中。
开发人员只要拿到指标ID，就可以明确指标的含义了，不需要费劲口舌和需求人扯皮指标的定义是什么。
由于指标索引可以确定每个指标的唯一性，所以，指标索引可以避免指标不统一的问题。

指标索引可以贯穿整个数据开发流程，可以用于自动化追踪指标的分布、指标之间的血缘关系、指标引用、被引用的频率，发现有对其他指标影响力的指标。


## 数据指标监控和报警的自动化

数据指标监控是一个精细的任务。涉及到上游数据量的监控，数据入库量的监控，数据指标的监控。

最难在于数据指标的监控。这里的指标，指的是指标索引的所有指标，而并非少数几个核心指标。

要解决数据指标监控的问题，需要给每个指标或者需求一个测试用例，旧的需求如果没有通过测试用例，则需要报警。新的需求如果没有测试用例，则不允许上线。

测试用例的检测项目可以有，数据指标的量，数据指标的范围，数据指标空或NULL的量，任务资源消耗等。

测试用例可以根据规则，自动生成。


### 数据血缘关系分析

要建成数据指标的监控体系，需要加入数据血缘关系的分析。所谓数据血缘关系，就是数据之间的引用关系，上下游关系，数据流转关系。

当上游数据发生异常的时候，应当告知下游数据受影响的范围和程度，并发出报警信息。


## 数据文档生成的自动化


在以上几点做好的情况下，数据文档是可以自动生成的。

为什么要自动生成文档呢？因为数据环节众多，数据指标众多，如果每个环节和指标的文档都由人工维护，会导致或者维护成本过高，或者文档远远落后于实际。

自动生成的文档，可以做到实时更新，保持可用性。



以上每个方案，我都考虑了其具体实现形式，迫于篇幅，在需要的时候再给出。






